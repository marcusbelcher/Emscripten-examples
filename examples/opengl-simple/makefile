CC=emcc
SOURCES=main.cpp app.cpp ../shared/esUtil/esUtil.cpp
CPPFLAGS=-I ../shared/esUtil/ 
LDFLAGS=-O3 --llvm-opts 2 --llvm-lto 1

all:
	$(CC) $(SOURCES) $(CPPFLAGS) --bind -s MODULARIZE=1 -s ASSERTIONS=1 -s USE_WEBGL2=1 -s EXPORT_NAME="'APPCpp'" -s AGGRESSIVE_VARIABLE_ELIMINATION=1 -s ELIMINATE_DUPLICATE_FUNCTIONS=1 -s INLINING_LIMIT=1 -s NO_EXIT_RUNTIME=1 -s EXPORTED_FUNCTIONS="['_malloc','_free']" -s TOTAL_MEMORY=67108864 -std=c++11 $(LDFLAGS) -o main.asm.js
#	$(CC) $(SOURCES) $(CPPFLAGS) --bind -s MODULARIZE=1 -s ASSERTIONS=1 -s USE_WEBGL2=1 -s EXPORT_NAME="'APPCpp'" -s AGGRESSIVE_VARIABLE_ELIMINATION=1 -s ELIMINATE_DUPLICATE_FUNCTIONS=1 -s INLINING_LIMIT=1 -s NO_EXIT_RUNTIME=1 -s EXPORTED_FUNCTIONS="['_malloc','_free']" -s TOTAL_MEMORY=67108864 -s WASM=1 -std=c++11  $(LDFLAGS) -o main.wasm.js

clean:
	rm -f $(OUTPUT)
